# Block committing .env files
if git diff --cached --name-only | grep -E '^\.env(\..+)?$' | grep -v '^\.env.example$' >/dev/null; then
  echo "❌ Refusing to commit .env files. Use .env.example and GitHub Secrets."
  exit 1
fi

# Run lint-staged and block commit on failure
if command -v pnpm >/dev/null 2>&1; then
  pnpm exec lint-staged || exit 1
else
  npx --no-install lint-staged || exit 1
fi
